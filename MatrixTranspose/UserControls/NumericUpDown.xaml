<!-- Custom control that implements a numeric spin button. -->
<!-- I do not understand why this is not a basic WPF control. -->
   <UserControl x:Class="MatrixTranspose.UserControls.NumericUpDown"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Name="Root">
   <UserControl.Style>
      <Style TargetType="UserControl">
         <Style.Triggers>
            <Trigger Property="IsEnabled" Value="False">
               <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
         </Style.Triggers>
      </Style>
   </UserControl.Style>

   <Grid Width="60">
      <Grid.ColumnDefinitions>
         <ColumnDefinition Width="*"/>
         <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>

      <!-- TextBox - IMPORTANT: Bind IsEnabled to parent -->
      <TextBox x:Name="TextBoxValue" 
                 Grid.Column="0"
                 Text="{Binding Value, RelativeSource={RelativeSource AncestorType=UserControl}, UpdateSourceTrigger=PropertyChanged}"
                 IsEnabled="{Binding IsEnabled, ElementName=Root}"
                 PreviewTextInput="TextBoxValue_PreviewTextInput"
                 PreviewKeyDown="TextBoxValue_PreviewKeyDown"
                 TextChanged="TextBoxValue_TextChanged"
                 VerticalContentAlignment="Center"
                 Padding="5,2"/>

      <StackPanel Grid.Column="1" Orientation="Vertical">
         <!-- Up Button - IMPORTANT: Bind IsEnabled to parent -->
         <Button x:Name="UpButton" 
                    Content="▲" 
                    Click="UpButton_Click"
                    Width="20" 
                    Height="15"
                    FontSize="8"
                    Margin="1,0,0,1"
                    IsEnabled="{Binding IsEnabled, ElementName=Root}"/>

         <!-- Down Button - IMPORTANT: Bind IsEnabled to parent -->
         <Button x:Name="DownButton" 
                    Content="▼" 
                    Click="DownButton_Click"
                    Width="20" 
                    Height="15"
                    FontSize="8"
                    Margin="1,0,0,0"
                    IsEnabled="{Binding IsEnabled, ElementName=Root}"/>
      </StackPanel>
   </Grid>
</UserControl>
   